{% if page.series %}
  {% assign all = site.posts | where: "series", page.series | sort: "series_order" %}
  {% assign total = all | size %}

  <div class="series-box">
    <p><strong>Series:</strong> {{ page.series }} â€” Part {{ page.series_order }} of {{ total }}</p>

    <ul>
      {% for p in all %}
        <li>
          {% if p.url == page.url %}
            <strong>{{ p.title }}</strong>
          {% else %}
            <a href="{{ p.url }}">{{ p.title }}</a>
          {% endif %}
        </li>
      {% endfor %}
    </ul>

    <div class="series-nav">
      {% assign prev = all | where: "series_order", page.series_order | minus: 1 | first %}
      {% assign next = all | where: "series_order", page.series_order | plus: 1 | first %}

      {% if prev %}
        <a href="{{ prev.url }}">&larr; Previous</a>
      {% endif %}

      {% if next %}
        <a href="{{ next.url }}" style="float:right;">Next &rarr;</a>
      {% endif %}
    </div>
  </div>
{% endif %}
